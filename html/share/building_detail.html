<!DOCTYPE html>
<html>
<head >
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1" />
    <meta name="keywords" content="" />
    <meta name="description" content=" "/>
    <meta charset="utf-8">
    <link href="../css/bootstrap.css" rel="stylesheet">
    <link href="../css/theme.css" rel="stylesheet">
    <script src="../js/jquery.js"></script>
    <script src="../js/bootstrap.js"></script>
    <script src="../js/script.js"></script>

</head>
<body style="background-color:#fff;">

<!--container -->
<div class="container-fluid" id="building">
    <div class="row">


        <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
            <!-- Indicators -->
            <ol class="carousel-indicators" id="indicators">
               
            </ol>

            <!-- Wrapper for slides -->
            <div class="carousel-inner" role="listbox" id="listbox">
     
            </div>

            <!-- Controls -->
            <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
                <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                <span class="sr-only">上一个</span>
            </a>
            <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
                <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                <span class="sr-only">下一个</span>
            </a>
        </div>


    </div> 

    <div class="row pt10 lh24">
        <div class="col-xs-9 relative border-right-dash ">
            <h4><span id="name"></span><span class="top-right">[<span id="area"></span>]</span></h4>
            <div class="border-bottom text-gray2">均价：<span id="price" class="price"></span>/平米</div>
        </div>
        <div class="col-xs-3 text-center">
            <div>已推荐</div>
            <div class="text-orange fs20 border-bottom-dash pb5" id="recommendedNum"></div>
        </div>
    </div>


    <div class="row pb10 lh28">
        <div class="col-xs-9 relative border-right-dash ">
            <div class="row">
                <div class="col-xs-6 text-danger">
                <span class="bg-danger badge mr5">佣</span><span id="ratio"></span> 
                </div>

                <div class="col-xs-6 pl0">
                    <span class="bg-danger badge mr5 pos-left-center">惠</span>
                    <div class="text-gray2 ml25 hui">
                        <span id="discount"></span>
                        <br>
                        <span id="discountEndTime"></span>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xs-3 text-center">
            <div>已预约</div>
            <div class="text-orange fs20 " id="bespeakNum"></div>
        </div>
    </div> 

    <div class="row bg-space"> </div>

    <div class="row pt15">
        <div class="col-xs-9 border-right">
            <div id="buildingType">
            </div>

            <table class="mt10 table table-condensed " id="intro">
                <tr>
                    <td width="70px">首期开盘：</td>
                    <td><span id="saleStartAt"></span></td>
                </tr>
                <tr>
                    <td>均&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;价：</td>
                    <td><span class="price"></span>元/平米</td>
                </tr>
                <tr>
                    <td>楼盘特色：</td>
                    <td><span id="salePoint"></span></td>
                </tr>
                <tr>
                    <td>产品类型：</td>
                    <td><span id="characteristic"></span></td>
                </tr>
                <tr>
                    <td>装修情况：</td>
                    <td><span id="fitmentLevelName"></span></td>
                </tr>
                <tr>
                    <td>占地面积：</td>
                    <td><span id="buildingArea"></span>平米</td>
                </tr>
                <tr>
                    <td>产&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;权：</td>
                    <td><span id="propertyRightsName"></span></td>
                </tr>
                <tr>
                    <td>绿&nbsp;&nbsp;化&nbsp;&nbsp;率：</td>
                    <td><span id="greeningRate"></span> </td>
                </tr>
                <tr>
                    <td>物业公司：</td>
                    <td> <span id="propertyCompany"></span> </td>
                </tr>
                <tr>
                    <td>交付时间：</td>
                    <td><span id="deliveryTime"></span> </td>
                </tr>

            </table>

            <hr/>

            <table class="table table-condensed " id="transport">
                <tr>
                    <td width="">交通情况：</td>
                    <td><span id="trafficCfg"></span> </td>
                </tr>
                
            </table>

            <hr/>

            <div class="row" id="layout">

               
<!--                 <div class="col-xs-6">
                    <div class="thumbnail">
                        <div class="relative">
                            <img src="../img/default/huxing.jpg" alt="">
                            <div class="thumb-text">3室2厅3卫<span class="pull-right">99平</span></div>
                        </div>
                        
                        <div class="caption">
                            <div class="text-center">户型A</div>
                        </div>
                    </div>
                </div> -->

            </div>

            <hr/>

            <div class="mb20" id="location">
                <img class="img-responsive" src="../img/default/location.jpg">
                <div id="address" class="location"></div>
            </div>
        </div>

        <div class="col-xs-3 pl5">
            <div data-spy="affix" data-offset-top="60" data-offset-bottom="120">
                <ul class="nav nav-pills nav-stacked customer-menu" id="navlist">
                    <li id="introTag" class="active"><a href="#intro">楼盘介绍</a></li>
                    <li id="transportTag" class=""><a href="#transport">交通配套</a></li>
                    <li id="layoutTag" class=""><a href="#layout">户型介绍</a></li>
                    <li id="locationTag" class=""><a href="#location">地图导航</a></li>
                </ul>
            </div>
        </div>
    </div>


<!--     <div class="nav-bottom-fixed">
        <div class="row">
            <div class="col-xs-6">
                <a href="" id="tel" class="btn btn-green">案场电话</a>
            </div>
            <div class="col-xs-6">
                <button class="btn btn-green">立即推荐</button>
            </div>
        </div>
    </div> -->


</div>
<!-- //container -->



</body>
</html>



<script>
$(document).ready(function(){

//设置信息
function setBuildingInfo(){
    var _this = BrokerWeb;
    

    var building = _this.building;

    //顶部图片轮播
    _this.setTopPics();

    //户型图
    _this.setLayout();

    //楼盘名称
    $("#name").html(building.name);

    //所在区名
    $("#area").html(building.area);

    //均价
    $(".price").html(building.price);

    //已推荐人数
    $("#recommendedNum").html(building.recommendedNum);

    //预约人数
    $("#bespeakNum").html(building.bespeakNum);

    //佣金比例
    $("#ratio").html(building.ratio);

    //优惠
    $("#discount").html(building.discount);
    $("#discountEndTime").html(building.discountEndTime);

    //产权
    $("#propertyRightsName").html(building.propertyRightsName);

    //特征
    var arr = building.buildingType.split('、');
    var str = '';
    $.each(arr, function(n,it){
        str += '<span class="label label-gray mr5">' + it + '</span>';
    });
    $("#buildingType").append(str);


    
    //首期开盘 
    $("#saleStartAt").html(building.saleStartAt);

    //楼盘特色
    $("#salePoint").html(building.salePoint);

    //产品类型
    $("#characteristic").html(building.characteristic);

    //装修情况
    $("#fitmentLevelName").html(building.fitmentLevelName);

    //占地面积
    $("#buildingArea").html(building.buildingArea);

    //绿化率
    $("#greeningRate").html(building.greeningRate);

    //物业公司
    $("#propertyCompany").html(building.propertyCompany);

    //交付时间
    $("#deliveryTime").html(building.deliveryTime);

    //交通情况
    $("#trafficCfg").html(building.trafficCfg);

    $("#tel").attr('href', 'tel:'+building.hotline);

    $("#address").html(building.address);
}

//顶部图片轮播
function setTopPics(){
    var _this = BrokerWeb;

    var pics = _this.building.picItems;
   
    $.each(pics, function(n, pic){
        
        $('<li></div>').attr({
            'data-target': '#carousel-example-generic',
            'data-slide-to': n,
            'class': ( n==0 ? 'active' : '' )
        }).appendTo($("#indicators"));

        var wp = $("<div></div>").addClass('item');
        if(n==0){
            wp.addClass('active');
        }
      
        var img = $("<img>").attr('src', pic.picUrl);
        wp.append(img);
        $("#listbox").append(wp);

    });
}

//户型图
function setLayout(){
    var _this = BrokerWeb;
    var layout = _this.building.houseTypeItems;

    var str = '';
    $.each(layout, function(n, it){
        it.houseTypeName = it.houseTypeName != null ? it.houseTypeName : '';
        
        str = '<div class="col-xs-6">'
                    +'<div class="thumbnail">'
                        +'<div class="relative">'
                            +'<img src="'+it.picUrl+'" alt="">'
                            +'<div class="thumb-text">'+it.houseTypeName
                                +'<span class="pull-right">'+it.houseTypeArea+'平</span></div>'
                        +'</div>'
                        
                        +'<div class="caption">'
                            +'<div class="text-center">'+it.houseType+'</div>'
                        +'</div>'
                    +'</div>'
                +'</div>';

        $("#layout").append(str);
    });
    

}

//获取经纪人信息
function getBuildingInfo(){
    var _this = BrokerWeb;
    $.ajax({
        url: _this.apiBaseUrl + '/broker/rest/building/queryBuildingInfo/' + _this.params.bid,
        type: 'GET',
        dataType: 'json',
        success: function(data){
            console.log(data);
            if(data.result){
                _this.building = data.objValue;
                
                _this.setBuildingInfo();


            }else{
                alert('获取信息失败');
            }

        },
        error: function(){
            //提交出错
        }

    });
}

function highlightTag(tag) {
    $("#introTag").removeClass('active');
    $("#transportTag").removeClass('active');
    $("#layoutTag").removeClass('active');
    $("#locationTag").removeClass('active');
    tag.addClass('active');
}

function main(){
    var _this = BrokerWeb;

    //获取信息
    _this.getBuildingInfo();

    $("#introTag").click(function(){
        _this.highlightTag($("#introTag"));
    });

    $("#transportTag").click(function(){
        _this.highlightTag($("#transportTag"));
    });

    $("#layoutTag").click(function(){
        _this.highlightTag($("#layoutTag"));
    });

    $("#locationTag").click(function(){
        _this.highlightTag($("#locationTag"));
    });
}

$.extend(BrokerWeb, {
    getBuildingInfo: getBuildingInfo,
    setBuildingInfo: setBuildingInfo,
    setTopPics: setTopPics,
    setLayout: setLayout,
    highlightTag: highlightTag
});

//主函数入口
//参数为main函数
BrokerWeb.init(main);

});

</script>


